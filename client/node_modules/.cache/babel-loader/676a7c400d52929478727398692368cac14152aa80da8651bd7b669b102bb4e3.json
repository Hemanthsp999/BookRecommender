{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\nconst {\n  STAGE_ADVANCED\n} = require(\"../OptimizationStages\");\nconst createSchemaValidation = require(\"../util/create-schema-validation\");\n\n/** @typedef {import(\"../../declarations/plugins/optimize/MinChunkSizePlugin\").MinChunkSizePluginOptions} MinChunkSizePluginOptions */\n/** @typedef {import(\"../Chunk\")} Chunk */\n/** @typedef {import(\"../Compiler\")} Compiler */\n\nconst validate = createSchemaValidation(require(\"../../schemas/plugins/optimize/MinChunkSizePlugin.check.js\"), () => require(\"../../schemas/plugins/optimize/MinChunkSizePlugin.json\"), {\n  name: \"Min Chunk Size Plugin\",\n  baseDataPath: \"options\"\n});\nclass MinChunkSizePlugin {\n  /**\n   * @param {MinChunkSizePluginOptions} options options object\n   */\n  constructor(options) {\n    validate(options);\n    this.options = options;\n  }\n\n  /**\n   * Apply the plugin\n   * @param {Compiler} compiler the compiler instance\n   * @returns {void}\n   */\n  apply(compiler) {\n    const options = this.options;\n    const minChunkSize = options.minChunkSize;\n    compiler.hooks.compilation.tap(\"MinChunkSizePlugin\", compilation => {\n      compilation.hooks.optimizeChunks.tap({\n        name: \"MinChunkSizePlugin\",\n        stage: STAGE_ADVANCED\n      }, chunks => {\n        const chunkGraph = compilation.chunkGraph;\n        const equalOptions = {\n          chunkOverhead: 1,\n          entryChunkMultiplicator: 1\n        };\n        const chunkSizesMap = new Map();\n        /** @type {[Chunk, Chunk][]} */\n        const combinations = [];\n        /** @type {Chunk[]} */\n        const smallChunks = [];\n        const visitedChunks = [];\n        for (const a of chunks) {\n          // check if one of the chunks sizes is smaller than the minChunkSize\n          // and filter pairs that can NOT be integrated!\n          if (chunkGraph.getChunkSize(a, equalOptions) < minChunkSize) {\n            smallChunks.push(a);\n            for (const b of visitedChunks) {\n              if (chunkGraph.canChunksBeIntegrated(b, a)) combinations.push([b, a]);\n            }\n          } else {\n            for (const b of smallChunks) {\n              if (chunkGraph.canChunksBeIntegrated(b, a)) combinations.push([b, a]);\n            }\n          }\n          chunkSizesMap.set(a, chunkGraph.getChunkSize(a, options));\n          visitedChunks.push(a);\n        }\n        const sortedSizeFilteredExtendedPairCombinations = combinations.map(pair => {\n          // extend combination pairs with size and integrated size\n          const a = chunkSizesMap.get(pair[0]);\n          const b = chunkSizesMap.get(pair[1]);\n          const ab = chunkGraph.getIntegratedChunksSize(pair[0], pair[1], options);\n          /** @type {[number, number, Chunk, Chunk]} */\n          const extendedPair = [a + b - ab, ab, pair[0], pair[1]];\n          return extendedPair;\n        }).sort((a, b) => {\n          // sadly javascript does an in place sort here\n          // sort by size\n          const diff = b[0] - a[0];\n          if (diff !== 0) return diff;\n          return a[1] - b[1];\n        });\n        if (sortedSizeFilteredExtendedPairCombinations.length === 0) return;\n        const pair = sortedSizeFilteredExtendedPairCombinations[0];\n        chunkGraph.integrateChunks(pair[2], pair[3]);\n        compilation.chunks.delete(pair[3]);\n        return true;\n      });\n    });\n  }\n}\nmodule.exports = MinChunkSizePlugin;","map":{"version":3,"names":["STAGE_ADVANCED","require","createSchemaValidation","validate","name","baseDataPath","MinChunkSizePlugin","constructor","options","apply","compiler","minChunkSize","hooks","compilation","tap","optimizeChunks","stage","chunks","chunkGraph","equalOptions","chunkOverhead","entryChunkMultiplicator","chunkSizesMap","Map","combinations","smallChunks","visitedChunks","a","getChunkSize","push","b","canChunksBeIntegrated","set","sortedSizeFilteredExtendedPairCombinations","map","pair","get","ab","getIntegratedChunksSize","extendedPair","sort","diff","length","integrateChunks","delete","module","exports"],"sources":["/home/hemanth/react-project/client/node_modules/webpack/lib/optimize/MinChunkSizePlugin.js"],"sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\nconst { STAGE_ADVANCED } = require(\"../OptimizationStages\");\nconst createSchemaValidation = require(\"../util/create-schema-validation\");\n\n/** @typedef {import(\"../../declarations/plugins/optimize/MinChunkSizePlugin\").MinChunkSizePluginOptions} MinChunkSizePluginOptions */\n/** @typedef {import(\"../Chunk\")} Chunk */\n/** @typedef {import(\"../Compiler\")} Compiler */\n\nconst validate = createSchemaValidation(\n\trequire(\"../../schemas/plugins/optimize/MinChunkSizePlugin.check.js\"),\n\t() => require(\"../../schemas/plugins/optimize/MinChunkSizePlugin.json\"),\n\t{\n\t\tname: \"Min Chunk Size Plugin\",\n\t\tbaseDataPath: \"options\"\n\t}\n);\n\nclass MinChunkSizePlugin {\n\t/**\n\t * @param {MinChunkSizePluginOptions} options options object\n\t */\n\tconstructor(options) {\n\t\tvalidate(options);\n\t\tthis.options = options;\n\t}\n\n\t/**\n\t * Apply the plugin\n\t * @param {Compiler} compiler the compiler instance\n\t * @returns {void}\n\t */\n\tapply(compiler) {\n\t\tconst options = this.options;\n\t\tconst minChunkSize = options.minChunkSize;\n\t\tcompiler.hooks.compilation.tap(\"MinChunkSizePlugin\", compilation => {\n\t\t\tcompilation.hooks.optimizeChunks.tap(\n\t\t\t\t{\n\t\t\t\t\tname: \"MinChunkSizePlugin\",\n\t\t\t\t\tstage: STAGE_ADVANCED\n\t\t\t\t},\n\t\t\t\tchunks => {\n\t\t\t\t\tconst chunkGraph = compilation.chunkGraph;\n\t\t\t\t\tconst equalOptions = {\n\t\t\t\t\t\tchunkOverhead: 1,\n\t\t\t\t\t\tentryChunkMultiplicator: 1\n\t\t\t\t\t};\n\n\t\t\t\t\tconst chunkSizesMap = new Map();\n\t\t\t\t\t/** @type {[Chunk, Chunk][]} */\n\t\t\t\t\tconst combinations = [];\n\t\t\t\t\t/** @type {Chunk[]} */\n\t\t\t\t\tconst smallChunks = [];\n\t\t\t\t\tconst visitedChunks = [];\n\t\t\t\t\tfor (const a of chunks) {\n\t\t\t\t\t\t// check if one of the chunks sizes is smaller than the minChunkSize\n\t\t\t\t\t\t// and filter pairs that can NOT be integrated!\n\t\t\t\t\t\tif (chunkGraph.getChunkSize(a, equalOptions) < minChunkSize) {\n\t\t\t\t\t\t\tsmallChunks.push(a);\n\t\t\t\t\t\t\tfor (const b of visitedChunks) {\n\t\t\t\t\t\t\t\tif (chunkGraph.canChunksBeIntegrated(b, a))\n\t\t\t\t\t\t\t\t\tcombinations.push([b, a]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfor (const b of smallChunks) {\n\t\t\t\t\t\t\t\tif (chunkGraph.canChunksBeIntegrated(b, a))\n\t\t\t\t\t\t\t\t\tcombinations.push([b, a]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchunkSizesMap.set(a, chunkGraph.getChunkSize(a, options));\n\t\t\t\t\t\tvisitedChunks.push(a);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst sortedSizeFilteredExtendedPairCombinations = combinations\n\t\t\t\t\t\t.map(pair => {\n\t\t\t\t\t\t\t// extend combination pairs with size and integrated size\n\t\t\t\t\t\t\tconst a = chunkSizesMap.get(pair[0]);\n\t\t\t\t\t\t\tconst b = chunkSizesMap.get(pair[1]);\n\t\t\t\t\t\t\tconst ab = chunkGraph.getIntegratedChunksSize(\n\t\t\t\t\t\t\t\tpair[0],\n\t\t\t\t\t\t\t\tpair[1],\n\t\t\t\t\t\t\t\toptions\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t/** @type {[number, number, Chunk, Chunk]} */\n\t\t\t\t\t\t\tconst extendedPair = [a + b - ab, ab, pair[0], pair[1]];\n\t\t\t\t\t\t\treturn extendedPair;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.sort((a, b) => {\n\t\t\t\t\t\t\t// sadly javascript does an in place sort here\n\t\t\t\t\t\t\t// sort by size\n\t\t\t\t\t\t\tconst diff = b[0] - a[0];\n\t\t\t\t\t\t\tif (diff !== 0) return diff;\n\t\t\t\t\t\t\treturn a[1] - b[1];\n\t\t\t\t\t\t});\n\n\t\t\t\t\tif (sortedSizeFilteredExtendedPairCombinations.length === 0) return;\n\n\t\t\t\t\tconst pair = sortedSizeFilteredExtendedPairCombinations[0];\n\n\t\t\t\t\tchunkGraph.integrateChunks(pair[2], pair[3]);\n\t\t\t\t\tcompilation.chunks.delete(pair[3]);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n}\nmodule.exports = MinChunkSizePlugin;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}