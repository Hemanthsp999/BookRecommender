{"ast":null,"code":"'use strict';\n\nvar Buffer = require('safe-buffer').Buffer,\n  Emitter = require('events').EventEmitter,\n  util = require('util'),\n  streams = require('../streams'),\n  Headers = require('./headers'),\n  Reader = require('./stream_reader');\nvar Base = function (request, url, options) {\n  Emitter.call(this);\n  Base.validateOptions(options || {}, ['maxLength', 'masking', 'requireMasking', 'protocols']);\n  this._request = request;\n  this._reader = new Reader();\n  this._options = options || {};\n  this._maxLength = this._options.maxLength || this.MAX_LENGTH;\n  this._headers = new Headers();\n  this.__queue = [];\n  this.readyState = 0;\n  this.url = url;\n  this.io = new streams.IO(this);\n  this.messages = new streams.Messages(this);\n  this._bindEventListeners();\n};\nutil.inherits(Base, Emitter);\nBase.isWebSocket = function (request) {\n  var connection = request.headers.connection || '',\n    upgrade = request.headers.upgrade || '';\n  return request.method === 'GET' && connection.toLowerCase().split(/ *, */).indexOf('upgrade') >= 0 && upgrade.toLowerCase() === 'websocket';\n};\nBase.validateOptions = function (options, validKeys) {\n  for (var key in options) {\n    if (validKeys.indexOf(key) < 0) throw new Error('Unrecognized option: ' + key);\n  }\n};\nvar instance = {\n  // This is 64MB, small enough for an average VPS to handle without\n  // crashing from process out of memory\n  MAX_LENGTH: 0x3ffffff,\n  STATES: ['connecting', 'open', 'closing', 'closed'],\n  _bindEventListeners: function () {\n    var self = this;\n\n    // Protocol errors are informational and do not have to be handled\n    this.messages.on('error', function () {});\n    this.on('message', function (event) {\n      var messages = self.messages;\n      if (messages.readable) messages.emit('data', event.data);\n    });\n    this.on('error', function (error) {\n      var messages = self.messages;\n      if (messages.readable) messages.emit('error', error);\n    });\n    this.on('close', function () {\n      var messages = self.messages;\n      if (!messages.readable) return;\n      messages.readable = messages.writable = false;\n      messages.emit('end');\n    });\n  },\n  getState: function () {\n    return this.STATES[this.readyState] || null;\n  },\n  addExtension: function (extension) {\n    return false;\n  },\n  setHeader: function (name, value) {\n    if (this.readyState > 0) return false;\n    this._headers.set(name, value);\n    return true;\n  },\n  start: function () {\n    if (this.readyState !== 0) return false;\n    if (!Base.isWebSocket(this._request)) return this._failHandshake(new Error('Not a WebSocket request'));\n    var response;\n    try {\n      response = this._handshakeResponse();\n    } catch (error) {\n      return this._failHandshake(error);\n    }\n    this._write(response);\n    if (this._stage !== -1) this._open();\n    return true;\n  },\n  _failHandshake: function (error) {\n    var headers = new Headers();\n    headers.set('Content-Type', 'text/plain');\n    headers.set('Content-Length', Buffer.byteLength(error.message, 'utf8'));\n    headers = ['HTTP/1.1 400 Bad Request', headers.toString(), error.message];\n    this._write(Buffer.from(headers.join('\\r\\n'), 'utf8'));\n    this._fail('protocol_error', error.message);\n    return false;\n  },\n  text: function (message) {\n    return this.frame(message);\n  },\n  binary: function (message) {\n    return false;\n  },\n  ping: function () {\n    return false;\n  },\n  pong: function () {\n    return false;\n  },\n  close: function (reason, code) {\n    if (this.readyState !== 1) return false;\n    this.readyState = 3;\n    this.emit('close', new Base.CloseEvent(null, null));\n    return true;\n  },\n  _open: function () {\n    this.readyState = 1;\n    this.__queue.forEach(function (args) {\n      this.frame.apply(this, args);\n    }, this);\n    this.__queue = [];\n    this.emit('open', new Base.OpenEvent());\n  },\n  _queue: function (message) {\n    this.__queue.push(message);\n    return true;\n  },\n  _write: function (chunk) {\n    var io = this.io;\n    if (io.readable) io.emit('data', chunk);\n  },\n  _fail: function (type, message) {\n    this.readyState = 2;\n    this.emit('error', new Error(message));\n    this.close();\n  }\n};\nfor (var key in instance) Base.prototype[key] = instance[key];\nBase.ConnectEvent = function () {};\nBase.OpenEvent = function () {};\nBase.CloseEvent = function (code, reason) {\n  this.code = code;\n  this.reason = reason;\n};\nBase.MessageEvent = function (data) {\n  this.data = data;\n};\nBase.PingEvent = function (data) {\n  this.data = data;\n};\nBase.PongEvent = function (data) {\n  this.data = data;\n};\nmodule.exports = Base;","map":{"version":3,"names":["Buffer","require","Emitter","EventEmitter","util","streams","Headers","Reader","Base","request","url","options","call","validateOptions","_request","_reader","_options","_maxLength","maxLength","MAX_LENGTH","_headers","__queue","readyState","io","IO","messages","Messages","_bindEventListeners","inherits","isWebSocket","connection","headers","upgrade","method","toLowerCase","split","indexOf","validKeys","key","Error","instance","STATES","self","on","event","readable","emit","data","error","writable","getState","addExtension","extension","setHeader","name","value","set","start","_failHandshake","response","_handshakeResponse","_write","_stage","_open","byteLength","message","toString","from","join","_fail","text","frame","binary","ping","pong","close","reason","code","CloseEvent","forEach","args","apply","OpenEvent","_queue","push","chunk","type","prototype","ConnectEvent","MessageEvent","PingEvent","PongEvent","module","exports"],"sources":["/home/hemanth/react-project/client/node_modules/websocket-driver/lib/websocket/driver/base.js"],"sourcesContent":["'use strict';\n\nvar Buffer  = require('safe-buffer').Buffer,\n    Emitter = require('events').EventEmitter,\n    util    = require('util'),\n    streams = require('../streams'),\n    Headers = require('./headers'),\n    Reader  = require('./stream_reader');\n\nvar Base = function(request, url, options) {\n  Emitter.call(this);\n  Base.validateOptions(options || {}, ['maxLength', 'masking', 'requireMasking', 'protocols']);\n\n  this._request   = request;\n  this._reader    = new Reader();\n  this._options   = options || {};\n  this._maxLength = this._options.maxLength || this.MAX_LENGTH;\n  this._headers   = new Headers();\n  this.__queue    = [];\n  this.readyState = 0;\n  this.url        = url;\n\n  this.io = new streams.IO(this);\n  this.messages = new streams.Messages(this);\n  this._bindEventListeners();\n};\nutil.inherits(Base, Emitter);\n\nBase.isWebSocket = function(request) {\n  var connection = request.headers.connection || '',\n      upgrade    = request.headers.upgrade || '';\n\n  return request.method === 'GET' &&\n         connection.toLowerCase().split(/ *, */).indexOf('upgrade') >= 0 &&\n         upgrade.toLowerCase() === 'websocket';\n};\n\nBase.validateOptions = function(options, validKeys) {\n  for (var key in options) {\n    if (validKeys.indexOf(key) < 0)\n      throw new Error('Unrecognized option: ' + key);\n  }\n};\n\nvar instance = {\n  // This is 64MB, small enough for an average VPS to handle without\n  // crashing from process out of memory\n  MAX_LENGTH: 0x3ffffff,\n\n  STATES: ['connecting', 'open', 'closing', 'closed'],\n\n  _bindEventListeners: function() {\n    var self = this;\n\n    // Protocol errors are informational and do not have to be handled\n    this.messages.on('error', function() {});\n\n    this.on('message', function(event) {\n      var messages = self.messages;\n      if (messages.readable) messages.emit('data', event.data);\n    });\n\n    this.on('error', function(error) {\n      var messages = self.messages;\n      if (messages.readable) messages.emit('error', error);\n    });\n\n    this.on('close', function() {\n      var messages = self.messages;\n      if (!messages.readable) return;\n      messages.readable = messages.writable = false;\n      messages.emit('end');\n    });\n  },\n\n  getState: function() {\n    return this.STATES[this.readyState] || null;\n  },\n\n  addExtension: function(extension) {\n    return false;\n  },\n\n  setHeader: function(name, value) {\n    if (this.readyState > 0) return false;\n    this._headers.set(name, value);\n    return true;\n  },\n\n  start: function() {\n    if (this.readyState !== 0) return false;\n\n    if (!Base.isWebSocket(this._request))\n      return this._failHandshake(new Error('Not a WebSocket request'));\n\n    var response;\n\n    try {\n      response = this._handshakeResponse();\n    } catch (error) {\n      return this._failHandshake(error);\n    }\n\n    this._write(response);\n    if (this._stage !== -1) this._open();\n    return true;\n  },\n\n  _failHandshake: function(error) {\n    var headers = new Headers();\n    headers.set('Content-Type', 'text/plain');\n    headers.set('Content-Length', Buffer.byteLength(error.message, 'utf8'));\n\n    headers = ['HTTP/1.1 400 Bad Request', headers.toString(), error.message];\n    this._write(Buffer.from(headers.join('\\r\\n'), 'utf8'));\n    this._fail('protocol_error', error.message);\n\n    return false;\n  },\n\n  text: function(message) {\n    return this.frame(message);\n  },\n\n  binary: function(message) {\n    return false;\n  },\n\n  ping: function() {\n    return false;\n  },\n\n  pong: function() {\n      return false;\n  },\n\n  close: function(reason, code) {\n    if (this.readyState !== 1) return false;\n    this.readyState = 3;\n    this.emit('close', new Base.CloseEvent(null, null));\n    return true;\n  },\n\n  _open: function() {\n    this.readyState = 1;\n    this.__queue.forEach(function(args) { this.frame.apply(this, args) }, this);\n    this.__queue = [];\n    this.emit('open', new Base.OpenEvent());\n  },\n\n  _queue: function(message) {\n    this.__queue.push(message);\n    return true;\n  },\n\n  _write: function(chunk) {\n    var io = this.io;\n    if (io.readable) io.emit('data', chunk);\n  },\n\n  _fail: function(type, message) {\n    this.readyState = 2;\n    this.emit('error', new Error(message));\n    this.close();\n  }\n};\n\nfor (var key in instance)\n  Base.prototype[key] = instance[key];\n\n\nBase.ConnectEvent = function() {};\n\nBase.OpenEvent = function() {};\n\nBase.CloseEvent = function(code, reason) {\n  this.code   = code;\n  this.reason = reason;\n};\n\nBase.MessageEvent = function(data) {\n  this.data = data;\n};\n\nBase.PingEvent = function(data) {\n  this.data = data;\n};\n\nBase.PongEvent = function(data) {\n  this.data = data;\n};\n\nmodule.exports = Base;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}