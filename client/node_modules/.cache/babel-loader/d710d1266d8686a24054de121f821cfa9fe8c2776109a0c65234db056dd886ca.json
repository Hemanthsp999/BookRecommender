{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Ivan Kopeykin @vankop\n*/\n\n\"use strict\";\n\nconst {\n  pathToFileURL\n} = require(\"url\");\nconst {\n  JAVASCRIPT_MODULE_TYPE_AUTO,\n  JAVASCRIPT_MODULE_TYPE_ESM\n} = require(\"../ModuleTypeConstants\");\nconst BasicEvaluatedExpression = require(\"../javascript/BasicEvaluatedExpression\");\nconst {\n  approve\n} = require(\"../javascript/JavascriptParserHelpers\");\nconst InnerGraph = require(\"../optimize/InnerGraph\");\nconst URLDependency = require(\"./URLDependency\");\n\n/** @typedef {import(\"estree\").NewExpression} NewExpressionNode */\n/** @typedef {import(\"../../declarations/WebpackOptions\").JavascriptParserOptions} JavascriptParserOptions */\n/** @typedef {import(\"../Compiler\")} Compiler */\n/** @typedef {import(\"../NormalModule\")} NormalModule */\n/** @typedef {import(\"../javascript/JavascriptParser\")} JavascriptParser */\n/** @typedef {import(\"../javascript/JavascriptParser\")} Parser */\n\nconst PLUGIN_NAME = \"URLPlugin\";\nclass URLPlugin {\n  /**\n   * @param {Compiler} compiler compiler\n   */\n  apply(compiler) {\n    compiler.hooks.compilation.tap(PLUGIN_NAME, (compilation, _ref) => {\n      let {\n        normalModuleFactory\n      } = _ref;\n      compilation.dependencyFactories.set(URLDependency, normalModuleFactory);\n      compilation.dependencyTemplates.set(URLDependency, new URLDependency.Template());\n\n      /**\n       * @param {NormalModule} module module\n       * @returns {URL} file url\n       */\n      const getUrl = module => {\n        return pathToFileURL(module.resource);\n      };\n\n      /**\n       * @param {Parser} parser parser parser\n       * @param {JavascriptParserOptions} parserOptions parserOptions\n       * @returns {void}\n       */\n      const parserCallback = (parser, parserOptions) => {\n        if (parserOptions.url === false) return;\n        const relative = parserOptions.url === \"relative\";\n\n        /**\n         * @param {NewExpressionNode} expr expression\n         * @returns {undefined | string} request\n         */\n        const getUrlRequest = expr => {\n          if (expr.arguments.length !== 2) return;\n          const [arg1, arg2] = expr.arguments;\n          if (arg2.type !== \"MemberExpression\" || arg1.type === \"SpreadElement\") return;\n          const chain = parser.extractMemberExpressionChain(arg2);\n          if (chain.members.length !== 1 || chain.object.type !== \"MetaProperty\" || chain.object.meta.name !== \"import\" || chain.object.property.name !== \"meta\" || chain.members[0] !== \"url\") return;\n          return parser.evaluateExpression(arg1).asString();\n        };\n        parser.hooks.canRename.for(\"URL\").tap(PLUGIN_NAME, approve);\n        parser.hooks.evaluateNewExpression.for(\"URL\").tap(PLUGIN_NAME, expr => {\n          const request = getUrlRequest(expr);\n          if (!request) return;\n          const url = new URL(request, getUrl(parser.state.module));\n          return new BasicEvaluatedExpression().setString(url.toString()).setRange(expr.range);\n        });\n        parser.hooks.new.for(\"URL\").tap(PLUGIN_NAME, _expr => {\n          const expr = /** @type {NewExpressionNode} */_expr;\n          const request = getUrlRequest(expr);\n          if (!request) return;\n          const [arg1, arg2] = expr.arguments;\n          const dep = new URLDependency(request, [arg1.range[0], arg2.range[1]], expr.range, relative);\n          dep.loc = expr.loc;\n          parser.state.current.addDependency(dep);\n          InnerGraph.onUsage(parser.state, e => dep.usedByExports = e);\n          return true;\n        });\n        parser.hooks.isPure.for(\"NewExpression\").tap(PLUGIN_NAME, _expr => {\n          const expr = /** @type {NewExpressionNode} */_expr;\n          const {\n            callee\n          } = expr;\n          if (callee.type !== \"Identifier\") return;\n          const calleeInfo = parser.getFreeInfoFromVariable(callee.name);\n          if (!calleeInfo || calleeInfo.name !== \"URL\") return;\n          const request = getUrlRequest(expr);\n          if (request) return true;\n        });\n      };\n      normalModuleFactory.hooks.parser.for(JAVASCRIPT_MODULE_TYPE_AUTO).tap(PLUGIN_NAME, parserCallback);\n      normalModuleFactory.hooks.parser.for(JAVASCRIPT_MODULE_TYPE_ESM).tap(PLUGIN_NAME, parserCallback);\n    });\n  }\n}\nmodule.exports = URLPlugin;","map":{"version":3,"names":["pathToFileURL","require","JAVASCRIPT_MODULE_TYPE_AUTO","JAVASCRIPT_MODULE_TYPE_ESM","BasicEvaluatedExpression","approve","InnerGraph","URLDependency","PLUGIN_NAME","URLPlugin","apply","compiler","hooks","compilation","tap","_ref","normalModuleFactory","dependencyFactories","set","dependencyTemplates","Template","getUrl","module","resource","parserCallback","parser","parserOptions","url","relative","getUrlRequest","expr","arguments","length","arg1","arg2","type","chain","extractMemberExpressionChain","members","object","meta","name","property","evaluateExpression","asString","canRename","for","evaluateNewExpression","request","URL","state","setString","toString","setRange","range","new","_expr","dep","loc","current","addDependency","onUsage","e","usedByExports","isPure","callee","calleeInfo","getFreeInfoFromVariable","exports"],"sources":["/home/hemanth/react-project/client/node_modules/webpack/lib/dependencies/URLPlugin.js"],"sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Ivan Kopeykin @vankop\n*/\n\n\"use strict\";\n\nconst { pathToFileURL } = require(\"url\");\nconst {\n\tJAVASCRIPT_MODULE_TYPE_AUTO,\n\tJAVASCRIPT_MODULE_TYPE_ESM\n} = require(\"../ModuleTypeConstants\");\nconst BasicEvaluatedExpression = require(\"../javascript/BasicEvaluatedExpression\");\nconst { approve } = require(\"../javascript/JavascriptParserHelpers\");\nconst InnerGraph = require(\"../optimize/InnerGraph\");\nconst URLDependency = require(\"./URLDependency\");\n\n/** @typedef {import(\"estree\").NewExpression} NewExpressionNode */\n/** @typedef {import(\"../../declarations/WebpackOptions\").JavascriptParserOptions} JavascriptParserOptions */\n/** @typedef {import(\"../Compiler\")} Compiler */\n/** @typedef {import(\"../NormalModule\")} NormalModule */\n/** @typedef {import(\"../javascript/JavascriptParser\")} JavascriptParser */\n/** @typedef {import(\"../javascript/JavascriptParser\")} Parser */\n\nconst PLUGIN_NAME = \"URLPlugin\";\n\nclass URLPlugin {\n\t/**\n\t * @param {Compiler} compiler compiler\n\t */\n\tapply(compiler) {\n\t\tcompiler.hooks.compilation.tap(\n\t\t\tPLUGIN_NAME,\n\t\t\t(compilation, { normalModuleFactory }) => {\n\t\t\t\tcompilation.dependencyFactories.set(URLDependency, normalModuleFactory);\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tURLDependency,\n\t\t\t\t\tnew URLDependency.Template()\n\t\t\t\t);\n\n\t\t\t\t/**\n\t\t\t\t * @param {NormalModule} module module\n\t\t\t\t * @returns {URL} file url\n\t\t\t\t */\n\t\t\t\tconst getUrl = module => {\n\t\t\t\t\treturn pathToFileURL(module.resource);\n\t\t\t\t};\n\n\t\t\t\t/**\n\t\t\t\t * @param {Parser} parser parser parser\n\t\t\t\t * @param {JavascriptParserOptions} parserOptions parserOptions\n\t\t\t\t * @returns {void}\n\t\t\t\t */\n\t\t\t\tconst parserCallback = (parser, parserOptions) => {\n\t\t\t\t\tif (parserOptions.url === false) return;\n\t\t\t\t\tconst relative = parserOptions.url === \"relative\";\n\n\t\t\t\t\t/**\n\t\t\t\t\t * @param {NewExpressionNode} expr expression\n\t\t\t\t\t * @returns {undefined | string} request\n\t\t\t\t\t */\n\t\t\t\t\tconst getUrlRequest = expr => {\n\t\t\t\t\t\tif (expr.arguments.length !== 2) return;\n\n\t\t\t\t\t\tconst [arg1, arg2] = expr.arguments;\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\targ2.type !== \"MemberExpression\" ||\n\t\t\t\t\t\t\targ1.type === \"SpreadElement\"\n\t\t\t\t\t\t)\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\tconst chain = parser.extractMemberExpressionChain(arg2);\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tchain.members.length !== 1 ||\n\t\t\t\t\t\t\tchain.object.type !== \"MetaProperty\" ||\n\t\t\t\t\t\t\tchain.object.meta.name !== \"import\" ||\n\t\t\t\t\t\t\tchain.object.property.name !== \"meta\" ||\n\t\t\t\t\t\t\tchain.members[0] !== \"url\"\n\t\t\t\t\t\t)\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\treturn parser.evaluateExpression(arg1).asString();\n\t\t\t\t\t};\n\n\t\t\t\t\tparser.hooks.canRename.for(\"URL\").tap(PLUGIN_NAME, approve);\n\t\t\t\t\tparser.hooks.evaluateNewExpression\n\t\t\t\t\t\t.for(\"URL\")\n\t\t\t\t\t\t.tap(PLUGIN_NAME, expr => {\n\t\t\t\t\t\t\tconst request = getUrlRequest(expr);\n\t\t\t\t\t\t\tif (!request) return;\n\t\t\t\t\t\t\tconst url = new URL(request, getUrl(parser.state.module));\n\n\t\t\t\t\t\t\treturn new BasicEvaluatedExpression()\n\t\t\t\t\t\t\t\t.setString(url.toString())\n\t\t\t\t\t\t\t\t.setRange(expr.range);\n\t\t\t\t\t\t});\n\t\t\t\t\tparser.hooks.new.for(\"URL\").tap(PLUGIN_NAME, _expr => {\n\t\t\t\t\t\tconst expr = /** @type {NewExpressionNode} */ (_expr);\n\n\t\t\t\t\t\tconst request = getUrlRequest(expr);\n\n\t\t\t\t\t\tif (!request) return;\n\n\t\t\t\t\t\tconst [arg1, arg2] = expr.arguments;\n\t\t\t\t\t\tconst dep = new URLDependency(\n\t\t\t\t\t\t\trequest,\n\t\t\t\t\t\t\t[arg1.range[0], arg2.range[1]],\n\t\t\t\t\t\t\texpr.range,\n\t\t\t\t\t\t\trelative\n\t\t\t\t\t\t);\n\t\t\t\t\t\tdep.loc = expr.loc;\n\t\t\t\t\t\tparser.state.current.addDependency(dep);\n\t\t\t\t\t\tInnerGraph.onUsage(parser.state, e => (dep.usedByExports = e));\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t});\n\t\t\t\t\tparser.hooks.isPure.for(\"NewExpression\").tap(PLUGIN_NAME, _expr => {\n\t\t\t\t\t\tconst expr = /** @type {NewExpressionNode} */ (_expr);\n\t\t\t\t\t\tconst { callee } = expr;\n\t\t\t\t\t\tif (callee.type !== \"Identifier\") return;\n\t\t\t\t\t\tconst calleeInfo = parser.getFreeInfoFromVariable(callee.name);\n\t\t\t\t\t\tif (!calleeInfo || calleeInfo.name !== \"URL\") return;\n\n\t\t\t\t\t\tconst request = getUrlRequest(expr);\n\n\t\t\t\t\t\tif (request) return true;\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tnormalModuleFactory.hooks.parser\n\t\t\t\t\t.for(JAVASCRIPT_MODULE_TYPE_AUTO)\n\t\t\t\t\t.tap(PLUGIN_NAME, parserCallback);\n\n\t\t\t\tnormalModuleFactory.hooks.parser\n\t\t\t\t\t.for(JAVASCRIPT_MODULE_TYPE_ESM)\n\t\t\t\t\t.tap(PLUGIN_NAME, parserCallback);\n\t\t\t}\n\t\t);\n\t}\n}\n\nmodule.exports = URLPlugin;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}