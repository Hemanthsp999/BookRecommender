{"ast":null,"code":"'use strict';\n\nvar Buffer = require('safe-buffer').Buffer,\n  crypto = require('crypto'),\n  url = require('url'),\n  util = require('util'),\n  HttpParser = require('../http_parser'),\n  Base = require('./base'),\n  Hybi = require('./hybi'),\n  Proxy = require('./proxy');\nvar Client = function (_url, options) {\n  this.version = 'hybi-' + Hybi.VERSION;\n  Hybi.call(this, null, _url, options);\n  this.readyState = -1;\n  this._key = Client.generateKey();\n  this._accept = Hybi.generateAccept(this._key);\n  this._http = new HttpParser('response');\n  var uri = url.parse(this.url),\n    auth = uri.auth && Buffer.from(uri.auth, 'utf8').toString('base64');\n  if (this.VALID_PROTOCOLS.indexOf(uri.protocol) < 0) throw new Error(this.url + ' is not a valid WebSocket URL');\n  this._pathname = (uri.pathname || '/') + (uri.search || '');\n  this._headers.set('Host', uri.host);\n  this._headers.set('Upgrade', 'websocket');\n  this._headers.set('Connection', 'Upgrade');\n  this._headers.set('Sec-WebSocket-Key', this._key);\n  this._headers.set('Sec-WebSocket-Version', Hybi.VERSION);\n  if (this._protocols.length > 0) this._headers.set('Sec-WebSocket-Protocol', this._protocols.join(', '));\n  if (auth) this._headers.set('Authorization', 'Basic ' + auth);\n};\nutil.inherits(Client, Hybi);\nClient.generateKey = function () {\n  return crypto.randomBytes(16).toString('base64');\n};\nvar instance = {\n  VALID_PROTOCOLS: ['ws:', 'wss:'],\n  proxy: function (origin, options) {\n    return new Proxy(this, origin, options);\n  },\n  start: function () {\n    if (this.readyState !== -1) return false;\n    this._write(this._handshakeRequest());\n    this.readyState = 0;\n    return true;\n  },\n  parse: function (chunk) {\n    if (this.readyState === 3) return;\n    if (this.readyState > 0) return Hybi.prototype.parse.call(this, chunk);\n    this._http.parse(chunk);\n    if (!this._http.isComplete()) return;\n    this._validateHandshake();\n    if (this.readyState === 3) return;\n    this._open();\n    this.parse(this._http.body);\n  },\n  _handshakeRequest: function () {\n    var extensions = this._extensions.generateOffer();\n    if (extensions) this._headers.set('Sec-WebSocket-Extensions', extensions);\n    var start = 'GET ' + this._pathname + ' HTTP/1.1',\n      headers = [start, this._headers.toString(), ''];\n    return Buffer.from(headers.join('\\r\\n'), 'utf8');\n  },\n  _failHandshake: function (message) {\n    message = 'Error during WebSocket handshake: ' + message;\n    this.readyState = 3;\n    this.emit('error', new Error(message));\n    this.emit('close', new Base.CloseEvent(this.ERRORS.protocol_error, message));\n  },\n  _validateHandshake: function () {\n    this.statusCode = this._http.statusCode;\n    this.headers = this._http.headers;\n    if (this._http.error) return this._failHandshake(this._http.error.message);\n    if (this._http.statusCode !== 101) return this._failHandshake('Unexpected response code: ' + this._http.statusCode);\n    var headers = this._http.headers,\n      upgrade = headers['upgrade'] || '',\n      connection = headers['connection'] || '',\n      accept = headers['sec-websocket-accept'] || '',\n      protocol = headers['sec-websocket-protocol'] || '';\n    if (upgrade === '') return this._failHandshake(\"'Upgrade' header is missing\");\n    if (upgrade.toLowerCase() !== 'websocket') return this._failHandshake(\"'Upgrade' header value is not 'WebSocket'\");\n    if (connection === '') return this._failHandshake(\"'Connection' header is missing\");\n    if (connection.toLowerCase() !== 'upgrade') return this._failHandshake(\"'Connection' header value is not 'Upgrade'\");\n    if (accept !== this._accept) return this._failHandshake('Sec-WebSocket-Accept mismatch');\n    this.protocol = null;\n    if (protocol !== '') {\n      if (this._protocols.indexOf(protocol) < 0) return this._failHandshake('Sec-WebSocket-Protocol mismatch');else this.protocol = protocol;\n    }\n    try {\n      this._extensions.activate(this.headers['sec-websocket-extensions']);\n    } catch (e) {\n      return this._failHandshake(e.message);\n    }\n  }\n};\nfor (var key in instance) Client.prototype[key] = instance[key];\nmodule.exports = Client;","map":{"version":3,"names":["Buffer","require","crypto","url","util","HttpParser","Base","Hybi","Proxy","Client","_url","options","version","VERSION","call","readyState","_key","generateKey","_accept","generateAccept","_http","uri","parse","auth","from","toString","VALID_PROTOCOLS","indexOf","protocol","Error","_pathname","pathname","search","_headers","set","host","_protocols","length","join","inherits","randomBytes","instance","proxy","origin","start","_write","_handshakeRequest","chunk","prototype","isComplete","_validateHandshake","_open","body","extensions","_extensions","generateOffer","headers","_failHandshake","message","emit","CloseEvent","ERRORS","protocol_error","statusCode","error","upgrade","connection","accept","toLowerCase","activate","e","key","module","exports"],"sources":["/home/hemanth/react-project/client/node_modules/websocket-driver/lib/websocket/driver/client.js"],"sourcesContent":["'use strict';\n\nvar Buffer     = require('safe-buffer').Buffer,\n    crypto     = require('crypto'),\n    url        = require('url'),\n    util       = require('util'),\n    HttpParser = require('../http_parser'),\n    Base       = require('./base'),\n    Hybi       = require('./hybi'),\n    Proxy      = require('./proxy');\n\nvar Client = function(_url, options) {\n  this.version = 'hybi-' + Hybi.VERSION;\n  Hybi.call(this, null, _url, options);\n\n  this.readyState = -1;\n  this._key       = Client.generateKey();\n  this._accept    = Hybi.generateAccept(this._key);\n  this._http      = new HttpParser('response');\n\n  var uri  = url.parse(this.url),\n      auth = uri.auth && Buffer.from(uri.auth, 'utf8').toString('base64');\n\n  if (this.VALID_PROTOCOLS.indexOf(uri.protocol) < 0)\n    throw new Error(this.url + ' is not a valid WebSocket URL');\n\n  this._pathname = (uri.pathname || '/') + (uri.search || '');\n\n  this._headers.set('Host', uri.host);\n  this._headers.set('Upgrade', 'websocket');\n  this._headers.set('Connection', 'Upgrade');\n  this._headers.set('Sec-WebSocket-Key', this._key);\n  this._headers.set('Sec-WebSocket-Version', Hybi.VERSION);\n\n  if (this._protocols.length > 0)\n    this._headers.set('Sec-WebSocket-Protocol', this._protocols.join(', '));\n\n  if (auth)\n    this._headers.set('Authorization', 'Basic ' + auth);\n};\nutil.inherits(Client, Hybi);\n\nClient.generateKey = function() {\n  return crypto.randomBytes(16).toString('base64');\n};\n\nvar instance = {\n  VALID_PROTOCOLS: ['ws:', 'wss:'],\n\n  proxy: function(origin, options) {\n    return new Proxy(this, origin, options);\n  },\n\n  start: function() {\n    if (this.readyState !== -1) return false;\n    this._write(this._handshakeRequest());\n    this.readyState = 0;\n    return true;\n  },\n\n  parse: function(chunk) {\n    if (this.readyState === 3) return;\n    if (this.readyState > 0) return Hybi.prototype.parse.call(this, chunk);\n\n    this._http.parse(chunk);\n    if (!this._http.isComplete()) return;\n\n    this._validateHandshake();\n    if (this.readyState === 3) return;\n\n    this._open();\n    this.parse(this._http.body);\n  },\n\n  _handshakeRequest: function() {\n    var extensions = this._extensions.generateOffer();\n    if (extensions)\n      this._headers.set('Sec-WebSocket-Extensions', extensions);\n\n    var start   = 'GET ' + this._pathname + ' HTTP/1.1',\n        headers = [start, this._headers.toString(), ''];\n\n    return Buffer.from(headers.join('\\r\\n'), 'utf8');\n  },\n\n  _failHandshake: function(message) {\n    message = 'Error during WebSocket handshake: ' + message;\n    this.readyState = 3;\n    this.emit('error', new Error(message));\n    this.emit('close', new Base.CloseEvent(this.ERRORS.protocol_error, message));\n  },\n\n  _validateHandshake: function() {\n    this.statusCode = this._http.statusCode;\n    this.headers    = this._http.headers;\n\n    if (this._http.error)\n      return this._failHandshake(this._http.error.message);\n\n    if (this._http.statusCode !== 101)\n      return this._failHandshake('Unexpected response code: ' + this._http.statusCode);\n\n    var headers    = this._http.headers,\n        upgrade    = headers['upgrade'] || '',\n        connection = headers['connection'] || '',\n        accept     = headers['sec-websocket-accept'] || '',\n        protocol   = headers['sec-websocket-protocol'] || '';\n\n    if (upgrade === '')\n      return this._failHandshake(\"'Upgrade' header is missing\");\n    if (upgrade.toLowerCase() !== 'websocket')\n      return this._failHandshake(\"'Upgrade' header value is not 'WebSocket'\");\n\n    if (connection === '')\n      return this._failHandshake(\"'Connection' header is missing\");\n    if (connection.toLowerCase() !== 'upgrade')\n      return this._failHandshake(\"'Connection' header value is not 'Upgrade'\");\n\n    if (accept !== this._accept)\n      return this._failHandshake('Sec-WebSocket-Accept mismatch');\n\n    this.protocol = null;\n\n    if (protocol !== '') {\n      if (this._protocols.indexOf(protocol) < 0)\n        return this._failHandshake('Sec-WebSocket-Protocol mismatch');\n      else\n        this.protocol = protocol;\n    }\n\n    try {\n      this._extensions.activate(this.headers['sec-websocket-extensions']);\n    } catch (e) {\n      return this._failHandshake(e.message);\n    }\n  }\n};\n\nfor (var key in instance)\n  Client.prototype[key] = instance[key];\n\nmodule.exports = Client;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}